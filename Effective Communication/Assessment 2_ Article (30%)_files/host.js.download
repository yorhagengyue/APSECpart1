(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.ifrauhost = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";module.exports=require("./src/host");
},{"./src/host":9}],2:[function(require,module,exports){
!function(e){"use strict";function n(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver}function i(e,n,i){"addEventListener"in window?e.addEventListener(n,i,!1):"attachEvent"in window&&e.attachEvent("on"+n,i)}function t(e,n,i){"removeEventListener"in window?e.removeEventListener(n,i,!1):"detachEvent"in window&&e.detachEvent("on"+n,i)}function o(){var e,n=["moz","webkit","o","ms"];for(e=0;e<n.length&&!q;e+=1)q=window[n[e]+"RequestAnimationFrame"];q||u("setup","RequestAnimationFrame not supported")}function r(e){var n="Host page: "+e;return window.top!==window.self&&(n=window.parentIFrame&&window.parentIFrame.getId?window.parentIFrame.getId()+": "+e:"Nested host page: "+e),n}function a(e){return A+"["+r(e)+"]"}function c(e){return V[e]?V[e].log:P}function u(e,n){d("log",e,n,c(e))}function s(e,n){d("info",e,n,c(e))}function f(e,n){d("warn",e,n,!0)}function d(e,n,i,t){!0===t&&"object"==typeof window.console&&console[e](a(n),i)}function l(e){function n(){function e(){v(N),p(W),C("resizedCallback",N)}o("Height"),o("Width"),k(e,N,"init")}function o(e){var n=Number(V[W]["max"+e]),i=Number(V[W]["min"+e]),t=e.toLowerCase(),o=Number(N[t]);u(W,"Checking "+t+" is in range "+i+"-"+n),o<i&&(o=i,u(W,"Set "+t+" to min value")),o>n&&(o=n,u(W,"Set "+t+" to max value")),N[t]=""+o}function r(e){return T.substr(T.indexOf(":")+S+e)}function a(e){u(W,"MessageCallback passed: {iframe: "+N.iframe.id+", message: "+e+"}"),C("messageCallback",{iframe:N.iframe,message:JSON.parse(e)}),u(W,"--")}function c(){var e=document.body.getBoundingClientRect(),n=N.iframe.getBoundingClientRect();return JSON.stringify({iframeHeight:n.height,iframeWidth:n.width,clientHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),offsetTop:parseInt(n.top-e.top,10),offsetLeft:parseInt(n.left-e.left,10),scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset})}function d(e,n){function i(){F("Send Page Info","pageInfo:"+c(),e,n)}z(i,32,n)}function l(){function e(e,i){function t(){V[o]?d(V[o].iframe,o):n()}["scroll","resize"].forEach(function(n){u(o,e+n+" listener for sendPageInfo"),i(window,n,t)})}function n(){e("Remove ",t)}var o=W;!function(){e("Add ",i)}(),V[o]&&(V[o].stopPageInfo=n)}function g(){V[W]&&V[W].stopPageInfo&&(V[W].stopPageInfo(),delete V[W].stopPageInfo)}function M(e){var n=e.getBoundingClientRect();return h(W),{x:Math.floor(Number(n.left)+Number(j.x)),y:Math.floor(Number(n.top)+Number(j.y))}}function x(e){var n=e?M(N.iframe):{x:0,y:0},i=function(){return{x:Number(N.width)+n.x,y:Number(N.height)+n.y}}();u(W,"Reposition requested from iFrame (offset x:"+n.x+" y:"+n.y+")"),window.top!==window.self?function(){window.parentIFrame?window.parentIFrame["scrollTo"+(e?"Offset":"")](i.x,i.y):f(W,"Unable to scroll to requested position, window.parentIFrame not found")}():function(){j=i,R(),u(W,"--")}()}function R(){!1!==C("scrollCallback",j)?p(W):b()}function E(e){var n=e.split("#")[1]||"",i=decodeURIComponent(n),t=document.getElementById(i)||document.getElementsByName(i)[0];t?function(){var e=M(t);u(W,"Moving to in page link (#"+n+") at x: "+e.x+" y: "+e.y),j={x:e.x,y:e.y},R(),u(W,"--")}():window.top!==window.self?function(){window.parentIFrame?window.parentIFrame.moveToAnchor(n):u(W,"In page link #"+n+" not found and window.parentIFrame not found")}():u(W,"In page link #"+n+" not found")}function C(e,n){return m(W,e,n)}function O(){V[W]&&(V[W].firstRun=!1)}var T=e.data,N={},W=null;"[iFrameResizerChild]Ready"===T?function(){for(var e in V)F("iFrame requested init",I(e),document.getElementById(e),e)}():function(){return A===(""+T).substr(0,L)&&T.substr(L).split(":")[0]in V}()?(N=function(){var e=T.substr(L).split(":");return{iframe:V[e[0]]&&V[e[0]].iframe,id:e[0],height:e[1],width:e[2],type:e[3]}}(),W=D=N.id,V[W]&&(V[W].loaded=!0),!function(){var e=N.type in{true:1,false:1,undefined:1};return e&&u(W,"Ignoring init message from meta parent page"),e}()&&function(e){var n=!0;return V[e]||(n=!1,f(N.type+" No settings for "+e+". Message was: "+T)),n}(W)&&(u(W,"Received: "+T),function(){var e=!0;return null===N.iframe&&(f(W,"IFrame ("+N.id+") not found"),e=!1),e}()&&function(){var n=e.origin,i=V[W]&&V[W].checkOrigin;if(i&&""+n!="null"&&!function(){return i.constructor===Array?function(){var e=0,t=!1;for(u(W,"Checking connection is from allowed list of origins: "+i);e<i.length;e++)if(i[e]===n){t=!0;break}return t}():function(){var e=V[W]&&V[W].remoteHost;return u(W,"Checking connection is from: "+e),n===e}()}())throw new Error("Unexpected message received from: "+n+" for "+N.iframe.id+". Message was: "+e.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return!0}()&&function(){switch(V[W]&&V[W].firstRun&&O(),N.type){case"close":V[W].closeRequestCallback?m(W,"closeRequestCallback",V[W].iframe):w(N.iframe);break;case"message":a(r(6));break;case"scrollTo":x(!1);break;case"scrollToOffset":x(!0);break;case"pageInfo":d(V[W]&&V[W].iframe,W),l();break;case"pageInfoStop":g();break;case"inPageLink":E(r(9));break;case"reset":y(N);break;case"init":n(),C("initCallback",N.iframe);break;default:n()}}())):s(W,"Ignored: "+T)}function m(e,n,i){var t=null,o=null;if(V[e]){if("function"!=typeof(t=V[e][n]))throw new TypeError(n+" on iFrame["+e+"] is not a function");o=t(i)}return o}function g(e){var n=e.id;delete V[n]}function w(e){var n=e.id;u(n,"Removing iFrame: "+n);try{e.parentNode&&e.parentNode.removeChild(e)}catch(e){}m(n,"closedCallback",n),u(n,"--"),g(e)}function h(n){null===j&&(j={x:window.pageXOffset!==e?window.pageXOffset:document.documentElement.scrollLeft,y:window.pageYOffset!==e?window.pageYOffset:document.documentElement.scrollTop},u(n,"Get page position: "+j.x+","+j.y))}function p(e){null!==j&&(window.scrollTo(j.x,j.y),u(e,"Set page position: "+j.x+","+j.y),b())}function b(){j=null}function y(e){function n(){v(e),F("reset","reset",e.iframe,e.id)}u(e.id,"Size reset requested by "+("init"===e.type?"host page":"iFrame")),h(e.id),k(n,e,"reset")}function v(e){function n(n){if(!e.id)return void u("undefined","messageData id not set");e.iframe.style[n]=e[n]+"px",u(e.id,"IFrame ("+o+") "+n+" set to "+e[n]+"px")}function i(n){H||"0"!==e[n]||(H=!0,u(o,"Hidden iFrame detected, creating visibility listener"),R())}function t(e){n(e),i(e)}var o=e.iframe.id;V[o]&&(V[o].sizeHeight&&t("height"),V[o].sizeWidth&&t("width"))}function k(e,n,i){i!==n.type&&q?(u(n.id,"Requesting animation frame"),q(e)):e()}function F(e,n,i,t,o){function r(){var o=V[t]&&V[t].targetOrigin;u(t,"["+e+"] Sending msg to iframe["+t+"] ("+n+") targetOrigin: "+o),i.contentWindow.postMessage(A+n,o)}function a(){f(t,"["+e+"] IFrame("+t+") not found")}var c=!1;t=t||i.id,V[t]&&(function(){i&&"contentWindow"in i&&null!==i.contentWindow?r():a()}(),function(){function e(){!V[t]||V[t].loaded||c||(c=!0,f(t,"IFrame has not responded within "+V[t].warningTimeout/1e3+" seconds. Check iFrameResizer.contentWindow.js has been loaded in iFrame. This message can be ignored if everything is working, or you can set the warningTimeout option to a higher value or zero to suppress this warning."))}o&&V[t]&&V[t].warningTimeout&&(V[t].msgTimeout=setTimeout(e,V[t].warningTimeout))}())}function I(e){return e+":"+V[e].bodyMarginV1+":"+V[e].sizeWidth+":"+V[e].log+":"+V[e].interval+":"+V[e].enablePublicMethods+":"+V[e].autoResize+":"+V[e].bodyMargin+":"+V[e].heightCalculationMethod+":"+V[e].bodyBackground+":"+V[e].bodyPadding+":"+V[e].tolerance+":"+V[e].inPageLinks+":"+V[e].resizeFrom+":"+V[e].widthCalculationMethod}function M(t,o){function r(){var e=o&&o.id||J.id+W++;return null!==document.getElementById(e)&&(e+=W++),e}function a(){var e=V[l]&&V[l].firstRun,n=V[l]&&V[l].heightCalculationMethod in B;!e&&n&&y({iframe:t,height:0,width:0,type:"init"})}function c(e){if("object"!=typeof e)throw new TypeError("Options is not an object")}function s(e){for(var n in J)J.hasOwnProperty(n)&&(V[l][n]=e.hasOwnProperty(n)?e[n]:J[n])}function d(e){return""===e||"file://"===e?"*":e}var l=function(e){return D=e,""===e&&(t.id=e=r(),P=(o||{}).log,D=e,u(e,"Added missing iframe ID: "+e+" ("+t.src+")")),e}(t.id);!function(){return l in V&&"iFrameResizer"in t}()?(function(e){e=e||{},V[l]={firstRun:!0,iframe:t,remoteHost:t.src.split("/").slice(0,3).join("/")},c(e),s(e),V[l]&&(V[l].targetOrigin=!0===V[l].checkOrigin?d(V[l].remoteHost):"*")}(o),function(){switch(u(l,"IFrame scrolling "+(V[l]&&V[l].scrolling?"enabled":"disabled")+" for "+l),t.style.overflow=!1===(V[l]&&V[l].scrolling)?"hidden":"auto",V[l]&&V[l].scrolling){case"omit":break;case!0:t.scrolling="yes";break;case!1:t.scrolling="no";break;default:t.scrolling=V[l]?V[l].scrolling:"no"}}(),function(){function e(e){1/0!==V[l][e]&&0!==V[l][e]&&(t.style[e]=V[l][e]+"px",u(l,"Set "+e+" = "+V[l][e]+"px"))}function n(e){if(V[l]["min"+e]>V[l]["max"+e])throw new Error("Value for min"+e+" can not be greater than max"+e)}n("Height"),n("Width"),e("maxHeight"),e("minHeight"),e("maxWidth"),e("minWidth")}(),function(){"number"!=typeof(V[l]&&V[l].bodyMargin)&&"0"!==(V[l]&&V[l].bodyMargin)||(V[l].bodyMarginV1=V[l].bodyMargin,V[l].bodyMargin=V[l].bodyMargin+"px")}(),function(o){function r(){F("iFrame.onload",o,t,e,!0),a()}var c=n();c&&function(e){t.parentNode&&new e(function(e){e.forEach(function(e){Array.prototype.slice.call(e.removedNodes).forEach(function(e){e===t&&w(t)})})}).observe(t.parentNode,{childList:!0})}(c),i(t,"load",r),F("init",o,t,e,!0)}(I(l)),function(){Function.prototype.bind&&V[l]&&(V[l].iframe.iFrameResizer={close:w.bind(null,V[l].iframe),removeListeners:g.bind(null,V[l].iframe),resize:F.bind(null,"Window resize","resize",V[l].iframe),moveToAnchor:function(e){F("Move to anchor","moveToAnchor:"+e,V[l].iframe,l)},sendMessage:function(e){e=JSON.stringify(e),F("Send Message","message:"+e,V[l].iframe,l)}})}()):f(l,"Ignored iFrame, already setup.")}function x(e,n){null===U&&(U=setTimeout(function(){U=null,e()},n))}function z(e,n,i){Q[i]||(Q[i]=setTimeout(function(){Q[i]=null,e()},n))}function R(){function e(){for(var e in V)!function(e){function n(n){return"0px"===(V[e]&&V[e].iframe.style[n])}V[e]&&function(e){return null!==e.offsetParent}(V[e].iframe)&&(n("height")||n("width"))&&F("Visibility change","resize",V[e].iframe,e)}(e)}function i(n){u("window","Mutation observed: "+n[0].target+" "+n[0].type),x(e,16)}var t=n();t&&function(){var e=document.querySelector("body"),n={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0};new t(i).observe(e,n)}()}function E(e){function n(){O("Window "+e,"resize")}u("window","Trigger event: "+e),x(n,16)}function C(){function e(){O("Tab Visable","resize")}"hidden"!==document.visibilityState&&(u("document","Trigger event: Visiblity change"),x(e,16))}function O(e,n){for(var i in V)(function(e){return V[e]&&"parent"===V[e].resizeFrom&&V[e].autoResize&&!V[e].firstRun})(i)&&F(e,n,document.getElementById(i),i)}function T(){i(window,"message",l),i(window,"resize",function(){E("resize")}),i(document,"visibilitychange",C),i(document,"-webkit-visibilitychange",C),i(window,"focusin",function(){E("focus")}),i(window,"focus",function(){E("focus")})}function N(){function n(e,n){n&&(!function(){if(!n.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==n.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+n.tagName+">")}(),M(n,e),t.push(n))}function i(e){e&&e.enablePublicMethods&&f("enablePublicMethods option has been removed, public methods are now always available in the iFrame")}var t;return o(),T(),function(o,r){switch(t=[],i(o),typeof r){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(r||"iframe"),n.bind(e,o));break;case"object":n(o,r);break;default:throw new TypeError("Unexpected data type ("+typeof r+")")}return t}}if("undefined"!=typeof window){var W=0,P=!1,H=!1,S="message".length,A="[iFrameSizer]",L=A.length,j=null,q=window.requestAnimationFrame,B={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},V={},U=null,D="Host Page",J={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,warningTimeout:5e3,tolerance:0,widthCalculationMethod:"scroll",closedCallback:function(){},initCallback:function(){},messageCallback:function(){f("MessageCallback function not defined")},resizedCallback:function(){},scrollCallback:function(){return!0}},Q={};window.jQuery&&function(e){e.fn?e.fn.iFrameResize||(e.fn.iFrameResize=function(e){function n(n,i){M(i,e)}return this.filter("iframe").each(n).end()}):s("","Unable to bind to jQuery, it is not fully loaded.")}(window.jQuery),"function"==typeof define&&define.amd?define([],N):"object"==typeof module&&"object"==typeof module.exports&&(module.exports=N()),window.iFrameResize=window.iFrameResize||N()}}();

},{}],3:[function(require,module,exports){
(function (global){
"use strict";function nextTick(){draining=!0;for(var e,n,a=queue.length;a;){for(n=queue,queue=[],e=-1;++e<a;)n[e]();a=queue.length}draining=!1}function immediate(e){1!==queue.push(e)||draining||scheduleDrain()}var Mutation=global.MutationObserver||global.WebKitMutationObserver,scheduleDrain;if(Mutation){var called=0,observer=new Mutation(nextTick),element=global.document.createTextNode("");observer.observe(element,{characterData:!0}),scheduleDrain=function(){element.data=called=++called%2}}else if(global.setImmediate||void 0===global.MessageChannel)scheduleDrain="document"in global&&"onreadystatechange"in global.document.createElement("script")?function(){var e=global.document.createElement("script");e.onreadystatechange=function(){nextTick(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},global.document.documentElement.appendChild(e)}:function(){setTimeout(nextTick,0)};else{var channel=new global.MessageChannel;channel.port1.onmessage=nextTick,scheduleDrain=function(){channel.port2.postMessage(0)}}var draining,queue=[];module.exports=immediate;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],4:[function(require,module,exports){
"function"==typeof Object.create?module.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:module.exports=function(t,e){if(e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t}};
},{}],5:[function(require,module,exports){
"use strict";function INTERNAL(){}function Promise(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=PENDING,this.queue=[],this.outcome=void 0,e!==INTERNAL&&safelyResolveThenable(this,e)}function QueueItem(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function unwrap(e,t,r){immediate(function(){var n;try{n=t(r)}catch(t){return handlers.reject(e,t)}n===e?handlers.reject(e,new TypeError("Cannot resolve promise with itself")):handlers.resolve(e,n)})}function getThen(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function safelyResolveThenable(e,t){function r(t){i||(i=!0,handlers.reject(e,t))}function n(t){i||(i=!0,handlers.resolve(e,t))}function o(){t(n,r)}var i=!1,s=tryCatch(o);"error"===s.status&&r(s.value)}function tryCatch(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}function resolve(e){return e instanceof this?e:handlers.resolve(new this(INTERNAL),e)}function reject(e){var t=new this(INTERNAL);return handlers.reject(t,e)}function all(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var o=new Array(r),i=0,s=-1,u=new this(INTERNAL);++s<r;)!function(e,s){function l(e){o[s]=e,++i!==r||n||(n=!0,handlers.resolve(u,o))}t.resolve(e).then(l,function(e){n||(n=!0,handlers.reject(u,e))})}(e[s],s);return u}function race(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var o=-1,i=new this(INTERNAL);++o<r;)!function(e){t.resolve(e).then(function(e){n||(n=!0,handlers.resolve(i,e))},function(e){n||(n=!0,handlers.reject(i,e))})}(e[o]);return i}var immediate=require("immediate"),handlers={},REJECTED=["REJECTED"],FULFILLED=["FULFILLED"],PENDING=["PENDING"];module.exports=Promise,Promise.prototype.finally=function(e){function t(t){function r(){return t}return n.resolve(e()).then(r)}function r(t){function r(){throw t}return n.resolve(e()).then(r)}if("function"!=typeof e)return this;var n=this.constructor;return this.then(t,r)},Promise.prototype.catch=function(e){return this.then(null,e)},Promise.prototype.then=function(e,t){if("function"!=typeof e&&this.state===FULFILLED||"function"!=typeof t&&this.state===REJECTED)return this;var r=new this.constructor(INTERNAL);if(this.state!==PENDING){unwrap(r,this.state===FULFILLED?e:t,this.outcome)}else this.queue.push(new QueueItem(r,e,t));return r},QueueItem.prototype.callFulfilled=function(e){handlers.resolve(this.promise,e)},QueueItem.prototype.otherCallFulfilled=function(e){unwrap(this.promise,this.onFulfilled,e)},QueueItem.prototype.callRejected=function(e){handlers.reject(this.promise,e)},QueueItem.prototype.otherCallRejected=function(e){unwrap(this.promise,this.onRejected,e)},handlers.resolve=function(e,t){var r=tryCatch(getThen,t);if("error"===r.status)return handlers.reject(e,r.value);var n=r.value;if(n)safelyResolveThenable(e,n);else{e.state=FULFILLED,e.outcome=t;for(var o=-1,i=e.queue.length;++o<i;)e.queue[o].callFulfilled(t)}return e},handlers.reject=function(e,t){e.state=REJECTED,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},Promise.resolve=resolve,Promise.reject=reject,Promise.all=all,Promise.race=race;
},{"immediate":3}],6:[function(require,module,exports){
function bytesToUuid(e,o){var t=o||0,i=byteToHex;return[i[e[t++]],i[e[t++]],i[e[t++]],i[e[t++]],"-",i[e[t++]],i[e[t++]],"-",i[e[t++]],i[e[t++]],"-",i[e[t++]],i[e[t++]],"-",i[e[t++]],i[e[t++]],i[e[t++]],i[e[t++]],i[e[t++]],i[e[t++]]].join("")}for(var byteToHex=[],i=0;i<256;++i)byteToHex[i]=(i+256).toString(16).substr(1);module.exports=bytesToUuid;

},{}],7:[function(require,module,exports){
var getRandomValues="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(getRandomValues){var rnds8=new Uint8Array(16);module.exports=function(){return getRandomValues(rnds8),rnds8}}else{var rnds=new Array(16);module.exports=function(){for(var n,e=0;e<16;e++)0==(3&e)&&(n=4294967296*Math.random()),rnds[e]=n>>>((3&e)<<3)&255;return rnds}}
},{}],8:[function(require,module,exports){
function v4(r,n,e){var i=n&&e||0;"string"==typeof r&&(n="binary"===r?new Array(16):null,r=null),r=r||{};var u=r.random||(r.rng||rng)();if(u[6]=15&u[6]|64,u[8]=63&u[8]|128,n)for(var o=0;o<16;++o)n[i+o]=u[o];return n||bytesToUuid(u)}var rng=require("./lib/rng"),bytesToUuid=require("./lib/bytesToUuid");module.exports=v4;
},{"./lib/bytesToUuid":6,"./lib/rng":7}],9:[function(require,module,exports){
"use strict";function Host(e,n,t){if(!(this instanceof Host))return new Host(e,n,t);t=t||{};var r=Host._tryGetOrigin(n);if(null===r)throw new Error('Unable to extract origin from "'+n+'"');var i=e();if(null===i)throw new Error("Could not find parent node");var s=Host._createIFrame(n,t.id,t.height,t.allowFullScreen);i.appendChild(s),Port.call(this,s.contentWindow,r,t),this.iframe=s,t.syncLang&&(this.use(syncLang),this.use(syncIntl),this.use(syncTimezone)),this.use(syncTitle({page:!!t.syncPageTitle})),t.height||0===t.height||!1===t.resizeFrame||this.use(resizer),t.syncFont&&this.use(syncFont),t.syncCssVariable&&this.use(syncCssVariable)}var inherits=require("inherits"),Promise=require("./promise-or-lie"),Port=require("./port"),resizer=require("./plugins/iframe-resizer/host"),syncFont=require("./plugins/sync-font/host"),syncLang=require("./plugins/sync-lang/host"),syncIntl=require("./plugins/sync-intl/host"),syncTimezone=require("./plugins/sync-timezone/host"),syncTitle=require("./plugins/sync-title/host"),syncCssVariable=require("./plugins/sync-css-variable/host"),originRe=/^(http:\/\/|https:\/\/)[^\/]+/i;inherits(Host,Port),Host.prototype.connect=function(){var e=this;return new Promise(function(n){e.onEvent("ready",function(){e._isConnected||n(Port.prototype.connect.call(e))}),e.open()})},Host._createIFrame=function(e,n,t,r){var i=document.createElement("iframe");return i.width="100%",(t||0===t)&&(i.style.height=t),i.style.border="none",i.style.overflow="hidden",i.scrolling="no",i.src=e,n&&(i.id=n),r&&i.setAttribute("allowfullscreen","allowfullscreen"),i},Host._tryGetOrigin=function(e){e&&0===e.indexOf("//")&&(e=window.location.protocol+e);var n=originRe.exec(e);return null!==n?n[0]:null},module.exports=Host;
},{"./plugins/iframe-resizer/host":10,"./plugins/sync-css-variable/host":11,"./plugins/sync-font/host":12,"./plugins/sync-intl/host":13,"./plugins/sync-lang/host":14,"./plugins/sync-timezone/host":15,"./plugins/sync-title/host":16,"./port":18,"./promise-or-lie":24,"inherits":4}],10:[function(require,module,exports){
"use strict";var iframeResizer=require("iframe-resizer/js/iframeResizer");module.exports=function(e){var r=!1;e.onEvent("ready",function(){r||(r=!0,iframeResizer({log:e.debugEnabled,heightCalculationMethod:"max"},e.iframe))}),e.onClose(function(){e.iframe&&e.iframe.iFrameResizer&&e.iframe.iFrameResizer.close(e.iframe)})};

},{"iframe-resizer/js/iframeResizer":2}],11:[function(require,module,exports){
"use strict";module.exports=function(t){t.onRequest("css-variable",function(){var t=document.getElementsByTagName("html");if(1===t.length&&t[0].hasAttribute("data-css-vars"))try{return JSON.parse(t[0].getAttribute("data-css-vars"))}catch(t){}return{}})};

},{}],12:[function(require,module,exports){
"use strict";module.exports=function(e){e.onRequest("font",function(){var e=window.getComputedStyle(document.body),t=document.body.classList.contains("visual-redesign");return{family:e.fontFamily,size:e.fontSize,visualRedesign:t}})};

},{}],13:[function(require,module,exports){
"use strict";module.exports=function(t){t.onRequest("intl",function(){var t=document.getElementsByTagName("html");if(1===t.length&&t[0].hasAttribute("data-intl-overrides"))try{return JSON.parse(t[0].getAttribute("data-intl-overrides"))}catch(t){}return{}})};

},{}],14:[function(require,module,exports){
"use strict";module.exports=function(t){t.onRequest("lang",function(){var t=document.getElementsByTagName("html")[0];return{isRtl:"rtl"===document.dir.toLowerCase(),lang:t.getAttribute("lang"),fallback:t.getAttribute("data-lang-default")}})};

},{}],15:[function(require,module,exports){
"use strict";module.exports=function(t){t.onRequest("timezone",function(){var t=document.getElementsByTagName("html");if(1===t.length&&t[0].hasAttribute("data-timezone"))try{return JSON.parse(t[0].getAttribute("data-timezone"))}catch(t){}return{identifier:"",name:""}})};

},{}],16:[function(require,module,exports){
"use strict";module.exports=function(t){return t=t||{},function(e){e.onEvent("title",function(n,i){!i&&t.page&&(document.title=n),e.iframe&&(e.iframe.title=n)})}};

},{}],17:[function(require,module,exports){
"use strict";function Port(e,t,s){if(!(this instanceof Port))return new Port(e,t,s);s=s||{},this._connectQueue=[],this._pluginStartupValues=[],this._debugEnabled=s.debug||!1,this._endpoint=e,this._eventHandlers={},this._isConnected=!1,this._isOpen=!1,this._messageHandlers={},this._onCloseCallbacks=[],this._targetOrigin=t,this._id=uuid();var n=this;this._onMessage("evt",function(){n._receiveEvent.apply(n,arguments)})}var uuid=require("uuid/v4"),Promise=require("../promise-or-lie"),validateEvent=require("./validate-event");Port.prototype.close=function(){if(!this._isOpen)throw new Error("Port cannot be closed, call open() first");this._isOpen=!1,this._isConnected=!1,window.removeEventListener("message",this._receiveMessage),this._onCloseCallbacks.forEach(function(e){e()}),this.debug("closed")},Port.prototype.connect=function(){var e=this;return this._isConnected=!0,this.debug("connected"),this._connectQueue.forEach(function(e){e()}),this._connectQueue=[],Promise.all(this._pluginStartupValues).then(function(){return e._pluginStartupValues=null,e})},Port.prototype.debug=function(e){this._debugEnabled&&console.log(e)},Port.prototype._initHashArrAndPush=function(e,t,s){void 0===e[t]&&(e[t]=[]),e[t].push(s)},Port.prototype.onClose=function(e){this._onCloseCallbacks.push(e)},Port.prototype.onEvent=function(e,t){return this.debug('onEvent handler added for "'+e+'"'),this._isConnected&&this.debug("You've attached event handlers after connecting, you may have missed some events"),this._initHashArrAndPush(this._eventHandlers,e,t),this},Port.prototype.open=function(){if(this._isOpen)throw new Error("Port is already open.");return this._isOpen=!0,window.addEventListener("message",this._receiveMessage.bind(this),!1),this.debug("opened"),this},Port.prototype._receiveMessage=function(e){if(validateEvent(this._targetOrigin,this._endpoint,e)){var t=e.data.key.substr(5,3),s=e.data.key.substr(9);this.debug("received "+t+"."+s);var n=this._messageHandlers[t];n&&n.call(this,s,e.data.payload)}},Port.prototype._onMessage=function(e,t){if(3!==e.length)throw new Error("message class name must be 3 characters");this._messageHandlers[e]=t},Port.prototype._receiveEvent=function(e,t){void 0!==this._eventHandlers[e]&&this._eventHandlers[e].forEach(function(e){e.apply(e,t)})},Port.prototype._sendMessage=function(e,t,s){var n={key:"frau."+e+"."+t,payload:s};return this.debug("sending key: "+n.key),this._endpoint.postMessage(n,this._targetOrigin),this},Port.prototype.sendEvent=function(e){for(var t=[],s=1;s<arguments.length;s++)t.push(arguments[s]);if(!this._isConnected){var n=this;return this._connectQueue.push(function(){n._sendMessage("evt",e,t)}),this}return this._sendMessage("evt",e,t)},Port.prototype.use=function(e){return this._pluginStartupValues.push(e(this)),this},module.exports=Port;
},{"../promise-or-lie":24,"./validate-event":23,"uuid/v4":8}],18:[function(require,module,exports){
"use strict";module.exports=require("./services");

},{"./services":21}],19:[function(require,module,exports){
"use strict";function RequestTypeError(e){this.name="RequestTypeError",this.message=e?'No onRequest handler for type "'+e+'"':"No handler defined for request"}var inherits=require("inherits");inherits(RequestTypeError,Error),module.exports=RequestTypeError;

},{"inherits":4}],20:[function(require,module,exports){
"use strict";function PortWithRequests(){if(!(this instanceof PortWithRequests))return new PortWithRequests.apply(this,arguments);Port.apply(this,arguments),this._pendingRequests={},this._requestHandlers={},this._requestCounter=0,this._waitingRequests=[];var e=this;this._onMessage("req",function(){e._receiveRequest.apply(e,arguments)}),this._onMessage("res",function(){e._receiveRequestResponse.apply(e,arguments)})}var inherits=require("inherits"),Promise=require("../promise-or-lie"),Port=require("./base"),RequestTypeError=require("./request-type-error"),fromError=require("./transform-error").fromError,toError=require("./transform-error").toError;inherits(PortWithRequests,Port),PortWithRequests.prototype.request=function(e){for(var r=new Array(arguments.length-1),t=1;t<arguments.length;++t)r[t-1]=arguments[t];var s=this;return new Promise(function(t,i){function n(){s._sendMessage("req",e,{id:u,args:r})}var o=++s._requestCounter,u=s._id+"_"+o;s._initHashArrAndPush(s._pendingRequests,e,{id:u,resolve:t,reject:i}),s._isConnected?n():s._connectQueue.push(n)})},PortWithRequests.prototype.onRequest=function(e,r){if(this._isConnected)throw new Error("Add request handlers before connecting");if(void 0!==this._requestHandlers[e])throw new Error('Duplicate onRequest handler for type "'+e+'"');return this.debug('onRequest handler added for "'+e+'"'),this._requestHandlers[e]=r,this._sendRequestResponse(e),this},PortWithRequests.prototype._receiveRequest=function(e,r){this._initHashArrAndPush(this._waitingRequests,e,r),this._sendRequestResponse(e)},PortWithRequests.prototype._sendRequestResponse=function(e){var r=this._requestHandlers[e],t=this._waitingRequests[e];if(delete this._waitingRequests[e],void 0!==t&&0!==t.length){var s=this;if(void 0===r){var i=fromError(new RequestTypeError(e));return void t.forEach(function(r){s._sendMessage("res",e,{id:r.id,err:i})})}t.forEach(function(t){Promise.resolve().then(function(){return"function"==typeof r?r.apply(r,t.args):r}).then(function(r){s._sendMessage("res",e,{id:t.id,val:r})}).catch(function(r){var i=fromError(r);s._sendMessage("res",e,{id:t.id,err:i})})})}},PortWithRequests.prototype._receiveRequestResponse=function(e,r){var t=this._pendingRequests[e];if(void 0!==t)for(var s=0;s<t.length;++s){var i=t[s];if(i.id===r.id){if(r.hasOwnProperty("err")){var n=toError(r.err);i.reject(n)}else i.resolve(r.val);return void t.splice(s,1)}}},module.exports=PortWithRequests;
},{"../promise-or-lie":24,"./base":17,"./request-type-error":19,"./transform-error":22,"inherits":4}],21:[function(require,module,exports){
"use strict";function PortWithServices(){if(!(this instanceof PortWithServices))return new PortWithServices.apply(this,arguments);PortWithRequests.apply(this,arguments)}var inherits=require("inherits"),PortWithRequests=require("./requests"),typeNameValidator=/^[a-zA-Z]+[a-zA-Z-]*$/;inherits(PortWithServices,PortWithRequests),PortWithServices.prototype.getService=function(e,t){function r(e){function t(e){return function(){var t=new Array(arguments.length+1);t[0]=i+":"+e;for(var r=0;r<arguments.length;++r)t[r+1]=arguments[r];return n.request.apply(n,t)}}var r={};return e.forEach(function(e){r[e]=t(e)}),r}if(!this._isConnected)throw new Error("Cannot getService() before connect() has completed");var i="service:"+e+":"+t,n=this;return n.request(i).then(r)},PortWithServices.prototype.registerService=function(e,t,r){if(this._isConnected)throw new Error("Register services before connecting");if(!typeNameValidator.test(e))throw new Error('Invalid service type "'+e+'"');var i="service:"+e+":"+t,n=Object.keys(r).filter(function(e){return"function"==typeof r[e]});this.onRequest(i,n);var o=this;return n.forEach(function(e){o.onRequest(i+":"+e,r[e])}),this},module.exports=PortWithServices;
},{"./requests":20,"inherits":4}],22:[function(require,module,exports){
"use strict";function deErrorifyArray(r){return r.map(deErrorify)}function errorifyArray(r){return r.map(errorify)}function deErrorifyObject(r){var e=r instanceof Error,o=e?{props:{}}:{};e&&(o.message=r.message,o.name=r.name,o[ERROR_OBJECT_SENTINEL]=!0);var n=e?o.props:o;return Object.keys(r).forEach(function(e){var o=deErrorify(r[e]);n[e]=o}),o}function errorifyObject(r){var e=!0===r[ERROR_OBJECT_SENTINEL],o=e?new Error(r.message):{};e&&(o.name=r.name);var n=e?r.props:r;return Object.keys(n).forEach(function(r){var e=errorify(n[r]);o[r]=e}),o}function deErrorify(r){return null!==r&&"object"==typeof r?Array.isArray(r)?deErrorifyArray(r):deErrorifyObject(r):"function"==typeof r?null:r}function errorify(r){return null!==r&&"object"==typeof r?Array.isArray(r)?errorifyArray(r):errorifyObject(r):r}var ERROR_OBJECT_SENTINEL="_ifrau-error-object";module.exports.ERROR_OBJECT_SENTINEL=ERROR_OBJECT_SENTINEL,module.exports.fromError=deErrorify,module.exports.toError=errorify;

},{}],23:[function(require,module,exports){
"use strict";function isStringEmpty(t){return!t||0===t.length}function validateEvent(t,e,i){return i.source===e&&("*"===t||!isStringEmpty(t)&&!isStringEmpty(i.origin)&&t.toUpperCase()===i.origin.toUpperCase())&&void 0!==i.data.key&&null!==i.data.key&&0===i.data.key.indexOf("frau.")}module.exports=validateEvent;
},{}],24:[function(require,module,exports){
(function (global){
"use strict";module.exports="undefined"==typeof Promise?require("lie"):global.Promise;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"lie":5}]},{},[1])(1)
});
